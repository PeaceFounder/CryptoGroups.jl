<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>ElGamal Cryptosystem · CryptoGroups.jl</title><meta name="title" content="ElGamal Cryptosystem · CryptoGroups.jl"/><meta property="og:title" content="ElGamal Cryptosystem · CryptoGroups.jl"/><meta property="twitter:title" content="ElGamal Cryptosystem · CryptoGroups.jl"/><meta name="description" content="Documentation for CryptoGroups.jl."/><meta property="og:description" content="Documentation for CryptoGroups.jl."/><meta property="twitter:description" content="Documentation for CryptoGroups.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">CryptoGroups.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Overview</a></li><li><span class="tocitem">Group Examples</span><ul><li><a class="tocitem" href="../dsa/">Digital Signature Algorithm</a></li><li><a class="tocitem" href="../kem/">Key Encapsulation Mechanism</a></li><li class="is-active"><a class="tocitem" href>ElGamal Cryptosystem</a></li><li><a class="tocitem" href="../knowledge_proof/">Proof of Knowledge</a></li></ul></li><li><span class="tocitem">Field Examples</span><ul><li><a class="tocitem" href="../lagrange/">Lagrange Polynomials</a></li><li><a class="tocitem" href="../reed-solomon/">Reed-Solomon EC</a></li><li><a class="tocitem" href="../external_fields/">Field Subtyping</a></li></ul></li><li><span class="tocitem">Reference</span><ul><li><a class="tocitem" href="../../groups/">Groups</a></li><li><a class="tocitem" href="../../curves/">Curves</a></li><li><a class="tocitem" href="../../fields/">Fields</a></li><li><a class="tocitem" href="../../utils/">Utils</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Group Examples</a></li><li class="is-active"><a href>ElGamal Cryptosystem</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>ElGamal Cryptosystem</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/PeaceFounder/CryptoGroups.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/PeaceFounder/CryptoGroups.jl/blob/master/examples/elgamal.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="ElGamal-Cryptosystem"><a class="docs-heading-anchor" href="#ElGamal-Cryptosystem">ElGamal Cryptosystem</a><a id="ElGamal-Cryptosystem-1"></a><a class="docs-heading-anchor-permalink" href="#ElGamal-Cryptosystem" title="Permalink"></a></h1><p>The ElGamal cryptosystem, as demonstrated in this Julia code example, is a fundamental component of many verifiable e-voting systems. This implementation showcases the core operations of the ElGamal encryption scheme, including key generation, encryption, and decryption and is implemented in a group agnostic way.</p><p>The example illustrates both scalar and vector cases of ElGamal encryption. It defines an <code>ElGamalRow</code> struct to represent encrypted messages, and implements functions for encryption (enc) and decryption (dec). The code demonstrates how to encrypt multiple messages simultaneously and how to work with tuples of group elements as well as vectors. By using Julia&#39;s multiple dispatch capabilities, the implementation provides a flexible and type-safe approach to handling different input types. The test cases at the end of the file are made using P-192 elliptic curve group verify the correctness of the encryption and decryption operations for both single-row and multi-row scenarios.</p><pre><code class="language-julia hljs">using Test
using CryptoGroups

struct ElGamalRow{G&lt;:Group, N}
    a::NTuple{N, G}
    b::NTuple{N, G}
end

ElGamalRow(m::NTuple{N, G}) where {N, G&lt;:Group} = convert(ElGamalRow{G, N}, m)
Base.convert(::Type{ElGamalRow{G, N}}, m::NTuple{N, G}) where {N, G &lt;: Group} = ElGamalRow{G, N}(one.(m), m)

enc(g::G, pk::G, e::ElGamalRow{G, N}, r::NTuple{N, &lt;:Integer}) where {N, G &lt;: Group} =
    ElGamalRow(e.a .* g .^ r, e.b .* pk .^ r)

enc(g::G, pk::G, m::NTuple{N, G}, r::NTuple{N, &lt;:Integer}) where {N, G &lt;: Group} = enc(g, pk, ElGamalRow(m), r)

dec(e::ElGamalRow{G}, x::Integer) where G &lt;: Group = e.b ./ e.a .^ x

# A scalar example with 3 row elements

g = @ECGroup{P_192}()

x = 42
pk = g^x

m = (g^2, g^3, g^4)

cyphertexts = enc(g, pk, m, (4, 5, 6))

plaintexts = dec(cyphertexts, x)

@test plaintexts == m #

# A vector case with 3 rows

mvec = NTuple{3, typeof(g)}[
    (g^2, g^3, g^4),
    (g^4, g^7, g^8),
    (g^3, g^9, g^2)
]

rvec = NTuple{3, Int}[
    (4, 5, 6),
    (4, 5, 6),
    (4, 5, 6)
]

cyphertexts_vec = ((m, r) -&gt; enc(g, pk, m, r)).(mvec, rvec)

plaintexts_vec = dec.(cyphertexts_vec, x)

@test plaintexts_vec == mvec</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr32"><span class="sgr1">Test Passed</span></span></code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../kem/">« Key Encapsulation Mechanism</a><a class="docs-footer-nextpage" href="../knowledge_proof/">Proof of Knowledge »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.6.0 on <span class="colophon-date" title="Sunday 8 September 2024 19:59">Sunday 8 September 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
